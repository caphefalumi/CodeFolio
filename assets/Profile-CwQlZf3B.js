import{f as m,_ as L,c as y,o as p,a as e,w as t,r as s,b as g,t as d,d as a,F as N,e as T,i as B,g as A}from"./index-DGz9mqfk.js";function E(){return sessionStorage.getItem("accessToken")}async function M(){return(await m.get("/api/users/me",{headers:{Authorization:`Bearer ${E()}`}})).data}async function G(){return(await m.get("/api/posts/me",{headers:{Authorization:`Bearer ${E()}`}})).data}const H={name:"ProfileView",data(){return{userProfile:{},userProjects:[],showEditProfile:!1,showNewProject:!1,loading:!1,editForm:{name:"",bio:"",avatar:null},projectForm:{title:"",description:"",image:null,tags:[],githubUrl:""}}},methods:{async fetchUserProfile(){try{this.userProfile=await M(),this.editForm.name=this.userProfile.name,this.editForm.bio=this.userProfile.bio}catch(i){console.error("Failed to fetch user profile:",i)}},async fetchUserProjects(){try{this.userProjects=await G()}catch(i){console.error("Failed to fetch projects:",i)}},async saveProfile(){this.loading=!0;try{let i=this.editForm.avatar;if(i&&typeof i=="object"){const b=new FormData;b.append("image",i),i=(await m.post("/api/upload/image/profile",b,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${this.accessToken}`}})).data.uri}const o={name:this.editForm.name,bio:this.editForm.bio,avatar:i};await m.patch("/api/users",o,{headers:{Authorization:`Bearer ${this.accessToken}`}}),this.fetchUserProfile(),this.showEditProfile=!1}catch(i){console.error("Profile update failed:",i)}finally{this.loading=!1}},async saveProject(){this.loading=!0;try{const i=await m.post("/api/posts",this.projectForm,{headers:{Authorization:`Bearer ${this.accessToken}`}});this.userProjects.push(i.data.post),this.showNewProject=!1,this.projectForm={title:"",description:"",image:null,tags:[],githubUrl:""}}catch(i){console.error("Project save failed:",i)}finally{this.loading=!1}},editProject(i){this.projectForm={...i},this.showNewProject=!0},async deleteProject(i){if(confirm("Are you sure you want to delete this project?")){this.loading=!0;try{await m.delete(`/api/posts/${i._id}`,{headers:{Authorization:`Bearer ${this.accessToken}`}}),this.userProjects=this.userProjects.filter(o=>o._id!==i._id)}catch(o){console.error("Project deletion failed:",o)}finally{this.loading=!1}}}},computed:{accessToken(){return sessionStorage.getItem("accessToken")}},mounted(){this.fetchUserProfile(),this.fetchUserProjects()}},J={class:"text-h4 mb-2"},K={class:"text-subtitle-1 mb-2"},O={class:"text-body-1"};function Q(i,o,b,S,r,u){const F=s("v-img"),c=s("v-card-text"),n=s("v-btn"),_=s("v-card-actions"),f=s("v-card"),j=s("v-col"),w=s("v-toolbar-title"),v=s("v-spacer"),V=s("v-toolbar"),z=s("v-card-title"),D=s("v-chip"),k=s("v-row"),R=s("v-container"),P=s("v-text-field"),x=s("v-file-input"),U=s("v-form"),C=s("v-dialog"),q=s("v-textarea"),I=s("v-combobox");return p(),y("div",null,[e(R,null,{default:t(()=>[e(k,{class:"mb-6"},{default:t(()=>[e(j,{cols:"12",md:"4"},{default:t(()=>[e(f,null,{default:t(()=>[e(F,{src:r.userProfile.avatar,height:"300",cover:""},null,8,["src"]),e(c,null,{default:t(()=>[g("h2",J,d(r.userProfile.name),1),g("p",K,d(r.userProfile.email),1),g("p",O,d(r.userProfile.bio),1)]),_:1}),e(_,null,{default:t(()=>[e(n,{color:"primary",variant:"outlined",onClick:o[0]||(o[0]=l=>r.showEditProfile=!0)},{default:t(()=>o[12]||(o[12]=[a(" Edit Profile ")])),_:1,__:[12]})]),_:1})]),_:1})]),_:1}),e(j,{cols:"12",md:"8"},{default:t(()=>[e(f,null,{default:t(()=>[e(V,{color:"primary",dark:"",flat:""},{default:t(()=>[e(w,null,{default:t(()=>o[13]||(o[13]=[a("My Projects")])),_:1,__:[13]}),e(v),e(n,{color:"white",variant:"text",onClick:o[1]||(o[1]=l=>r.showNewProject=!0)},{default:t(()=>o[14]||(o[14]=[a(" Add New Project ")])),_:1,__:[14]})]),_:1}),e(c,null,{default:t(()=>[e(k,null,{default:t(()=>[(p(!0),y(N,null,T(r.userProjects,l=>(p(),A(j,{key:l.id,cols:"12",md:"6"},{default:t(()=>[e(f,null,{default:t(()=>[e(F,{src:l.image,height:"200",cover:""},null,8,["src"]),e(z,null,{default:t(()=>[a(d(l.title),1)]),_:2},1024),e(c,null,{default:t(()=>[g("p",null,d(l.description),1),(p(!0),y(N,null,T(l.tags,h=>(p(),A(D,{key:h,class:"mr-2 mb-2",size:"small"},{default:t(()=>[a(d(h),1)]),_:2},1024))),128))]),_:2},1024),e(_,null,{default:t(()=>[e(n,{color:"primary",variant:"text",to:"/project/"+l.id},{default:t(()=>o[15]||(o[15]=[a(" View ")])),_:2,__:[15]},1032,["to"]),e(n,{color:"primary",variant:"text",onClick:h=>u.editProject(l)},{default:t(()=>o[16]||(o[16]=[a(" Edit ")])),_:2,__:[16]},1032,["onClick"]),e(v),e(n,{color:"error",variant:"text",onClick:h=>u.deleteProject(l)},{default:t(()=>o[17]||(o[17]=[a(" Delete ")])),_:2,__:[17]},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(C,{modelValue:r.showEditProfile,"onUpdate:modelValue":o[5]||(o[5]=l=>r.showEditProfile=l),"max-width":"500"},{default:t(()=>[e(f,null,{default:t(()=>[e(V,{color:"primary",dark:"",flat:""},{default:t(()=>[e(w,null,{default:t(()=>o[18]||(o[18]=[a("Edit Profile")])),_:1,__:[18]})]),_:1}),e(c,null,{default:t(()=>[e(U,{onSubmit:B(u.saveProfile,["prevent"])},{default:t(()=>[e(P,{modelValue:r.editForm.name,"onUpdate:modelValue":o[2]||(o[2]=l=>r.editForm.name=l),label:"Name",required:""},null,8,["modelValue"]),e(P,{modelValue:r.editForm.bio,"onUpdate:modelValue":o[3]||(o[3]=l=>r.editForm.bio=l),label:"Bio",multiline:"",rows:"3"},null,8,["modelValue"]),e(x,{modelValue:r.editForm.avatar,"onUpdate:modelValue":o[4]||(o[4]=l=>r.editForm.avatar=l),label:"Profile Picture",accept:"image/*","prepend-icon":"mdi-camera"},null,8,["modelValue"])]),_:1},8,["onSubmit"])]),_:1}),e(_,null,{default:t(()=>[e(v),e(n,{color:"primary",onClick:u.saveProfile,loading:r.loading},{default:t(()=>o[19]||(o[19]=[a(" Save Changes ")])),_:1,__:[19]},8,["onClick","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(C,{modelValue:r.showNewProject,"onUpdate:modelValue":o[11]||(o[11]=l=>r.showNewProject=l),"max-width":"800"},{default:t(()=>[e(f,null,{default:t(()=>[e(V,{color:"primary",dark:"",flat:""},{default:t(()=>[e(w,null,{default:t(()=>o[20]||(o[20]=[a("Add New Project")])),_:1,__:[20]})]),_:1}),e(c,null,{default:t(()=>[e(U,{onSubmit:B(u.saveProject,["prevent"])},{default:t(()=>[e(P,{modelValue:r.projectForm.title,"onUpdate:modelValue":o[6]||(o[6]=l=>r.projectForm.title=l),label:"Project Title",required:""},null,8,["modelValue"]),e(q,{modelValue:r.projectForm.description,"onUpdate:modelValue":o[7]||(o[7]=l=>r.projectForm.description=l),label:"Project Description",required:""},null,8,["modelValue"]),e(x,{modelValue:r.projectForm.image,"onUpdate:modelValue":o[8]||(o[8]=l=>r.projectForm.image=l),label:"Project Image",accept:"image/*","prepend-icon":"mdi-image"},null,8,["modelValue"]),e(I,{modelValue:r.projectForm.tags,"onUpdate:modelValue":o[9]||(o[9]=l=>r.projectForm.tags=l),label:"Tags",multiple:"",chips:"","small-chips":""},null,8,["modelValue"]),e(P,{modelValue:r.projectForm.githubUrl,"onUpdate:modelValue":o[10]||(o[10]=l=>r.projectForm.githubUrl=l),label:"GitHub Repository URL","prepend-icon":"mdi-github"},null,8,["modelValue"])]),_:1},8,["onSubmit"])]),_:1}),e(_,null,{default:t(()=>[e(v),e(n,{color:"primary",onClick:u.saveProject,loading:r.loading},{default:t(()=>o[21]||(o[21]=[a(" Save Project ")])),_:1,__:[21]},8,["onClick","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}const X=L(H,[["render",Q]]);export{X as default};
