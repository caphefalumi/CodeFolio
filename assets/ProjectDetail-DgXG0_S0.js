import{_ as q,c as D,o as p,a as o,f as v,g as S,w as e,h as z,r as a,b as n,d as i,t as d,F as L,i as M,k as J,j as K,p as b,e as g}from"./index-C60KAqoL.js";const O={name:"ProjectDetailView",data(){return{project:{title:"",description:"",image:"",author:"",tags:[],githubUrl:"",createdAt:"",updatedAt:"",views:0,upvotes:0,downvotes:0,upvoting:!1,downvoting:!1},githubStats:{stars:0,forks:0,issues:0},comments:[],newComment:"",errorMessage:"",showAuthBanner:!1,authBannerTimeout:null,loading:!1}},methods:{async fetchProjectDetail(){try{const{username:r,id:t}=this.$route.params;let u={};const h=b&&b();h&&(u.Authorization=`Bearer ${h}`);const l=(await g.get(`/api/posts/${r}/${t}`,{headers:u})).data;this.project={title:l.title,description:l.description,image:l.coverImage,author:l.author.username,tags:l.tags||[],githubUrl:l.githubUrl,createdAt:new Date(l.createdAt).toLocaleDateString(),updatedAt:new Date(l.updatedAt).toLocaleDateString(),views:l.views,upvotes:l.upvotes||0,downvotes:l.downvotes||0,upvoting:!1,downvoting:!1,liked:l.liked},this.comments=(l.comments||[]).map(f=>({id:f._id,author:f.user.username,date:new Date(f.createdAt).toLocaleDateString(),content:f.content})),this.project.githubUrl&&this.fetchGitHubStats()}catch(r){console.error("Error fetching project detail:",r)}},async fetchGitHubStats(){try{const r=this.project.githubUrl.replace("https://github.com/","https://api.github.com/repos/"),t=await g.get(r),{stargazers_count:u,forks_count:h,open_issues_count:s}=t.data;this.githubStats={stars:u,forks:h,issues:s}}catch(r){console.error("Error fetching GitHub stats:",r)}},toggleLike(){this.project.liked=!this.project.liked},async addComment(){var r,t;this.errorMessage="",this.loading=!0;try{if(!this.newComment.trim())return;const u=b(),h=await g.post(`/api/posts/${this.$route.params.id}/comments`,{content:this.newComment},{headers:{Authorization:`Bearer ${u}`}});this.comments.unshift({id:`c${Date.now()}`,author:"You",date:new Date().toLocaleDateString(),content:this.newComment}),this.newComment=""}catch(u){this.errorMessage=((t=(r=u.response)==null?void 0:r.data)==null?void 0:t.message)||u.message||"Failed to post comment. Please try again."}finally{this.loading=!1}},async upvoteProject(){if(!this.project.upvoting){this.project.upvoting=!0;try{const r=b(),t=await g.post(`/api/posts/${this.$route.params.id}/upvote`,{},{headers:{Authorization:`Bearer ${r}`}});this.project.upvotes=t.data.upvotes,this.project.downvotes=t.data.downvotes,this.project.liked=t.data.liked}catch(r){this.handleVoteError(r)}finally{this.project.upvoting=!1}}},async downvoteProject(){if(!this.project.downvoting){this.project.downvoting=!0;try{const r=b(),t=await g.post(`/api/posts/${this.$route.params.id}/downvote`,{},{headers:{Authorization:`Bearer ${r}`}});this.project.upvotes=t.data.upvotes,this.project.downvotes=t.data.downvotes,this.project.liked=t.data.liked}catch(r){this.handleVoteError(r)}finally{this.project.downvoting=!1}}},handleVoteError(r){var t,u;r.response&&r.response.status===401?(this.showAuthBanner=!0,clearTimeout(this.authBannerTimeout),this.authBannerTimeout=setTimeout(()=>{this.showAuthBanner=!1},5e3)):this.errorMessage=((u=(t=r.response)==null?void 0:t.data)==null?void 0:u.message)||r.message||"Failed to vote."}},mounted(){this.fetchProjectDetail()}},Q={class:"text-body-1 mb-4"},R={role:"list","aria-label":"Project tags"},W={class:"text-h5 font-weight-bold mx-2",style:{"min-width":"32px","text-align":"center"},"aria-live":"polite"},X={"aria-labelledby":"github-stats-heading"},Z={class:"text-center"},$={class:"text-h4","aria-label":"Stars count"},tt={class:"text-center"},et={class:"text-h4","aria-label":"Forks count"},ot={class:"text-center"},st={class:"text-h4","aria-label":"Issues count"},rt={"aria-labelledby":"project-details-heading"},nt={"aria-labelledby":"comments-heading"};function at(r,t,u,h,s,l){const f=a("v-img"),w=a("v-card-title"),T=a("v-card-subtitle"),E=a("v-chip"),j=a("v-card-text"),_=a("v-icon"),y=a("v-btn"),F=a("v-spacer"),G=a("v-card-actions"),k=a("v-card"),m=a("v-col"),B=a("v-row"),x=a("v-list-item-title"),A=a("v-list-item-subtitle"),C=a("v-list-item"),P=a("v-list"),V=a("v-alert"),H=a("v-textarea"),I=a("v-form"),N=a("v-avatar"),Y=a("v-container"),U=K("auto-animate");return p(),D("div",null,[o(Y,null,{default:e(()=>[z((p(),v(B,null,{default:e(()=>[o(m,{cols:"12"},{default:e(()=>[n("article",null,[o(k,null,{default:e(()=>[o(f,{src:s.project.image,height:"400",cover:"",alt:`${s.project.title} project cover image`},null,8,["src","alt"]),o(w,{class:"text-h3"},{default:e(()=>[n("h1",null,d(s.project.title),1)]),_:1}),o(T,null,{default:e(()=>[t[1]||(t[1]=i(" By ")),n("span",null,d(s.project.author),1)]),_:1,__:[1]}),o(j,null,{default:e(()=>[n("p",Q,d(s.project.description),1),n("div",R,[(p(!0),D(L,null,M(s.project.tags,c=>(p(),v(E,{key:c,class:"mr-2 mb-2",role:"listitem"},{default:e(()=>[i(d(c),1)]),_:2},1024))),128))])]),_:1}),t[5]||(t[5]=i()),o(G,{class:"justify-center align-center",role:"group","aria-label":"Project voting actions"},{default:e(()=>[o(y,{icon:"",onClick:l.upvoteProject,disabled:s.project.upvoting,class:"mr-2","aria-label":`Upvote project. Current score: ${s.project.upvotes-s.project.downvotes}`,title:"Upvote this project"},{default:e(()=>[o(_,{color:s.project.liked===!0?"success":"grey","aria-hidden":"true"},{default:e(()=>t[2]||(t[2]=[i("mdi-arrow-up-bold")])),_:1,__:[2]},8,["color"])]),_:1},8,["onClick","disabled","aria-label"]),n("div",W,d(s.project.upvotes-s.project.downvotes),1),o(y,{icon:"",onClick:l.downvoteProject,disabled:s.project.downvoting,class:"ml-2","aria-label":`Downvote project. Current score: ${s.project.upvotes-s.project.downvotes}`,title:"Downvote this project"},{default:e(()=>[o(_,{color:s.project.liked===!1?"error":"grey","aria-hidden":"true"},{default:e(()=>t[3]||(t[3]=[i("mdi-arrow-down-bold")])),_:1,__:[3]},8,["color"])]),_:1},8,["onClick","disabled","aria-label"]),o(F),o(y,{color:"primary",variant:"text",href:s.project.githubUrl,target:"_blank","prepend-icon":"mdi-github",rel:"noopener noreferrer","aria-label":"View project on GitHub (opens in new tab)"},{default:e(()=>t[4]||(t[4]=[i(" View on GitHub ")])),_:1,__:[4]},8,["href"])]),_:1})]),_:1,__:[5]})])]),_:1}),s.project.githubUrl?(p(),v(m,{key:0,cols:"12",md:"6"},{default:e(()=>[n("section",X,[o(k,null,{default:e(()=>[o(w,null,{default:e(()=>t[6]||(t[6]=[n("h2",{id:"github-stats-heading"},"GitHub Stats",-1)])),_:1,__:[6]}),o(j,null,{default:e(()=>[o(B,null,{default:e(()=>[o(m,{cols:"4"},{default:e(()=>[n("div",Z,[n("div",$,d(s.githubStats.stars),1),t[7]||(t[7]=n("div",{class:"text-subtitle-1"},"Stars",-1))])]),_:1}),o(m,{cols:"4"},{default:e(()=>[n("div",tt,[n("div",et,d(s.githubStats.forks),1),t[8]||(t[8]=n("div",{class:"text-subtitle-1"},"Forks",-1))])]),_:1}),o(m,{cols:"4"},{default:e(()=>[n("div",ot,[n("div",st,d(s.githubStats.issues),1),t[9]||(t[9]=n("div",{class:"text-subtitle-1"},"Issues",-1))])]),_:1})]),_:1})]),_:1})]),_:1})])]),_:1})):S("",!0),o(m,{cols:"12",md:"6"},{default:e(()=>[n("section",rt,[o(k,null,{default:e(()=>[o(w,null,{default:e(()=>t[10]||(t[10]=[n("h2",{id:"project-details-heading"},"Project Details",-1)])),_:1,__:[10]}),o(j,null,{default:e(()=>[o(P,null,{default:e(()=>[o(C,null,{prepend:e(()=>[o(_,{"aria-hidden":"true"},{default:e(()=>t[11]||(t[11]=[i("mdi-calendar")])),_:1,__:[11]})]),default:e(()=>[o(x,null,{default:e(()=>t[12]||(t[12]=[i("Created")])),_:1,__:[12]}),o(A,null,{default:e(()=>[i(d(s.project.createdAt),1)]),_:1})]),_:1}),o(C,null,{prepend:e(()=>[o(_,{"aria-hidden":"true"},{default:e(()=>t[13]||(t[13]=[i("mdi-update")])),_:1,__:[13]})]),default:e(()=>[o(x,null,{default:e(()=>t[14]||(t[14]=[i("Last Updated")])),_:1,__:[14]}),o(A,null,{default:e(()=>[i(d(s.project.updatedAt),1)]),_:1})]),_:1}),o(C,null,{prepend:e(()=>[o(_,{"aria-hidden":"true"},{default:e(()=>t[15]||(t[15]=[i("mdi-eye")])),_:1,__:[15]})]),default:e(()=>[o(x,null,{default:e(()=>t[16]||(t[16]=[i("Views")])),_:1,__:[16]}),o(A,null,{default:e(()=>[i(d(s.project.views),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])]),_:1}),o(m,{cols:"12"},{default:e(()=>[n("section",nt,[o(k,null,{default:e(()=>[o(w,null,{default:e(()=>t[17]||(t[17]=[n("h2",{id:"comments-heading"},"Comments",-1)])),_:1,__:[17]}),o(j,null,{default:e(()=>[s.errorMessage?(p(),v(V,{key:0,type:"error",class:"mb-4",border:"start","colored-border":"",elevation:"0",density:"comfortable",style:{"background-color":"#fff",color:"#d32f2f","font-weight":"500"},role:"alert","aria-live":"polite"},{prepend:e(()=>[o(_,{color:"error",size:"24","aria-hidden":"true"},{default:e(()=>t[18]||(t[18]=[i("mdi-alert-circle")])),_:1,__:[18]})]),default:e(()=>[i(" "+d(s.errorMessage),1)]),_:1})):S("",!0),o(I,{onSubmit:J(l.addComment,["prevent"]),"aria-label":"Add a comment"},{default:e(()=>[o(H,{modelValue:s.newComment,"onUpdate:modelValue":t[0]||(t[0]=c=>s.newComment=c),label:"Add a comment",rows:"3",variant:"outlined","aria-label":"Share your thoughts about this project"},null,8,["modelValue"]),o(y,{color:"primary",type:"submit",disabled:!s.newComment.trim(),"aria-label":s.loading?"Posting comment...":"Post comment"},{default:e(()=>t[19]||(t[19]=[i(" Post Comment ")])),_:1,__:[19]},8,["disabled","aria-label"])]),_:1},8,["onSubmit"])]),_:1}),z((p(),v(P,{"aria-label":"Project comments"},{default:e(()=>[(p(!0),D(L,null,M(s.comments,c=>(p(),v(C,{key:c.id,subtitle:c.author+" â€¢ "+c.date,role:"article","aria-label":`Comment by ${c.author} on ${c.date}`},{prepend:e(()=>[o(N,{color:"primary","aria-label":`${c.author} avatar`},{default:e(()=>[i(d(c.author.charAt(0)),1)]),_:2},1032,["aria-label"])]),default:e(()=>[o(x,null,{default:e(()=>[i(d(c.content),1)]),_:2},1024)]),_:2},1032,["subtitle","aria-label"]))),128))]),_:1})),[[U]])]),_:1})])]),_:1})]),_:1})),[[U]])]),_:1}),s.showAuthBanner?(p(),v(V,{key:0,type:"warning",class:"mb-4 fade-banner auth-banner-fixed text-center",border:"start","colored-border":"",elevation:"0",density:"comfortable",style:{"background-color":"#fffbe7",color:"#b26a00","font-weight":"500",transition:"opacity 1s","z-index":"9999"}},{prepend:e(()=>[o(_,{color:"warning",size:"24"},{default:e(()=>t[20]||(t[20]=[i("mdi-alert")])),_:1,__:[20]})]),default:e(()=>[t[21]||(t[21]=n("div",{class:"banner-center"},"You must be logged in to vote on projects.",-1))]),_:1,__:[21]})):S("",!0)])}const lt=q(O,[["render",at],["__scopeId","data-v-6f0d4ab5"]]);export{lt as default};
