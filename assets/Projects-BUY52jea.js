import{_ as j,c as _,o as c,a as l,w as a,b as u,f as m,g as b,r as i,h as L,F as A,i as B,e as v,j as C}from"./index-Cf56jlRU.js";import{A as T,u as x}from"./common-BqFF8ER1.js";import{P as M}from"./ProjectCard-D47rBc0z.js";const D={name:"ProjectsView",components:{AppAlert:T,ProjectCard:M},setup(){const{handleError:e}=x();return{handleError:e}},data(){return{projects:[],search:"",selectedType:"all",sortBy:"newest",page:1,itemsPerPage:6,projectTypes:[{title:"All Types",value:"all"},{title:"Web App",value:"web"},{title:"Mobile App",value:"mobile"},{title:"Game",value:"game"},{title:"Design",value:"design"}],sortOptions:[{title:"Newest First",value:"newest"},{title:"Most Liked",value:"liked"},{title:"Most Viewed",value:"viewed"}],errorMessage:""}},computed:{filteredProjects(){let e=this.projects;if(this.selectedType!=="all"&&(e=e.filter(t=>t.type===this.selectedType)),this.search)if(this.search.startsWith("#")){const t=this.search.slice(1).toLowerCase();e=e.filter(s=>Array.isArray(s.tags)&&s.tags.some(h=>h.toLowerCase().includes(t)))}else e=e.filter(t=>{var s;return t.title.toLowerCase().includes(this.search.toLowerCase())||((s=t.description)==null?void 0:s.toLowerCase().includes(this.search.toLowerCase()))});return this.sortBy==="newest"?e=e.sort((t,s)=>new Date(s.createdAt)-new Date(t.createdAt)):this.sortBy==="liked"?e=e.sort((t,s)=>(s.upvotes||0)-(t.upvotes||0)):this.sortBy==="viewed"&&(e=e.sort((t,s)=>(s.views||0)-(t.views||0))),e},totalPages(){return Math.ceil(this.filteredProjects.length/this.itemsPerPage)},paginatedProjects(){const e=(this.page-1)*this.itemsPerPage;return this.filteredProjects.slice(e,e+this.itemsPerPage)}},methods:{viewProject(e){var t;this.$router.push(`/${((t=e.author)==null?void 0:t.username)||"unknown"}/${e._id}`)},async toggleLike(e){try{if(e.liked){const t=await v.post(`https://server-codefolio.vercel.app/api/posts/${e._id}/downvote`);e.downvotes=t.data.downvotes,e.liked=!1}else{const t=await v.post(`https://server-codefolio.vercel.app/api/posts/${e._id}/upvote`);e.upvotes=t.data.upvotes,e.liked=!0}}catch(t){this.errorMessage=this.handleError(t,"Failed to update vote. Please try again.")}}},async mounted(){try{const e=await v.get("https://server-codefolio.vercel.app/api/posts/");this.projects=e.data,console.log("Projects:",this.projects)}catch(e){console.error("Error fetching projects:",e)}}};function E(e,t,s,h,o,d){const g=i("v-text-field"),n=i("v-col"),f=i("v-select"),p=i("v-row"),w=i("project-card"),y=i("v-pagination"),P=i("app-alert"),V=i("v-container"),k=C("auto-animate");return c(),_("div",null,[l(V,null,{default:a(()=>[u("section",null,[l(p,{class:"mb-6"},{default:a(()=>[l(n,{cols:"12",md:"6"},{default:a(()=>[l(g,{modelValue:o.search,"onUpdate:modelValue":t[0]||(t[0]=r=>o.search=r),label:"Search projects","prepend-inner-icon":"mdi-magnify",variant:"outlined","hide-details":""},null,8,["modelValue"])]),_:1}),l(n,{cols:"12",md:"3"},{default:a(()=>[l(f,{modelValue:o.selectedType,"onUpdate:modelValue":t[1]||(t[1]=r=>o.selectedType=r),items:o.projectTypes,"item-title":"title","item-value":"value",label:"Project Type",variant:"outlined","hide-details":""},null,8,["modelValue","items"])]),_:1}),l(n,{cols:"12",md:"3"},{default:a(()=>[l(f,{modelValue:o.sortBy,"onUpdate:modelValue":t[2]||(t[2]=r=>o.sortBy=r),items:o.sortOptions,"item-title":"title","item-value":"value",label:"Sort By",variant:"outlined","hide-details":""},null,8,["modelValue","items"])]),_:1})]),_:1})]),u("section",null,[L((c(),m(p,null,{default:a(()=>[(c(!0),_(A,null,B(d.paginatedProjects,r=>(c(),m(n,{key:r._id,cols:"12",md:"4"},{default:a(()=>[u("article",null,[l(w,{project:r,"show-edit-button":!1,"show-delete-button":!1,"show-like-button":!0,onView:d.viewProject,onLike:d.toggleLike},null,8,["project","onView","onLike"])])]),_:2},1024))),128))]),_:1})),[[k]])]),u("section",null,[l(p,{class:"mt-6"},{default:a(()=>[l(n,{cols:"12",class:"text-center"},{default:a(()=>[l(y,{modelValue:o.page,"onUpdate:modelValue":t[3]||(t[3]=r=>o.page=r),length:d.totalPages,rounded:""},null,8,["modelValue","length"])]),_:1})]),_:1})]),o.errorMessage?(c(),m(P,{key:0,type:"error",message:o.errorMessage,"custom-class":"mb-4"},null,8,["message"])):b("",!0)]),_:1})])}const O=j(D,[["render",E]]);export{O as default};
