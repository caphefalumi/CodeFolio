import{_ as h,f as u,o as g,w as n,g as b,d,r as o,t as w,C,a as t,b as c,k as I,e as f}from"./index-ClXwWzJ6.js";const B={name:"VIconLogin",props:{provider:{type:String,required:!0}},computed:{providerName(){return this.provider}}};function A(i,e,r,l,s,a){const m=o("v-icon"),_=o("v-btn");return g(),u(_,{class:"login-btn",block:"",elevation:"1","aria-label":`Sign in with ${a.providerName} - opens ${a.providerName} authentication`,role:"button",tabindex:"0"},{default:n(()=>[r.provider==="google"?(g(),u(m,{key:0,left:"",class:"me-2 google-icon",color:"#EA4335","aria-hidden":!0})):r.provider==="github"?(g(),u(m,{key:1,left:"",class:"me-2 github-icon",color:"#4267B2","aria-hidden":!0})):b("",!0),d(" Login with "+w(a.providerName),1)]),_:1},8,["aria-label"])}const P=h(B,[["render",A],["__scopeId","data-v-7591c01a"]]),U={components:{GoogleLogin:C,vIconLogin:P},data(){return{loading:!1,errorMessage:"",form:{email:"",password:""},rules:{required:i=>!!i||"This field is required",email:i=>/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/.test(i)||"Email must be valid"}}},mounted(){window.addEventListener("message",this.receiveGithubToken)},beforeUnmount(){window.removeEventListener("message",this.receiveGithubToken)},methods:{async handleLogin(){var i,e;this.errorMessage="",this.loading=!0;try{const r=await f.post("/api/auth/login/jwt",{email:this.form.email,password:this.form.password},{withCredentials:!0});sessionStorage.setItem("accessToken",r.data.accessToken),this.$router.push("/")}catch(r){this.errorMessage=((e=(i=r.response)==null?void 0:i.data)==null?void 0:e.message)||r.message||"An unexpected error occurred. Please try again."}finally{this.loading=!1}},async handleGoogleLogin(i){var e,r;this.errorMessage="",this.loading=!0;try{const l=await f.post("/api/auth/login/google",{token:i.access_token});sessionStorage.setItem("accessToken",l.data.accessToken),window.location.href="/"}catch(l){this.errorMessage=((r=(e=l.response)==null?void 0:e.data)==null?void 0:r.message)||l.message||"Google login failed. Please try again"}finally{this.loading=!1}},handleGithubLogin(){this.errorMessage="",window.open("/api/auth/login/github","GitHub Login","width=500,height=600")},receiveGithubToken(i){if(i.origin!=="http://localhost:3001")return;const{accessToken:e,error:r}=i.data||{};e?(sessionStorage.setItem("accessToken",e),window.location.href="/"):r&&(this.errorMessage=r)}}},j={class:"login-buttons",role:"group","aria-label":"Alternative login methods"},D={class:"login-btn-wrapper"},O={class:"text-center mt-4"};function z(i,e,r,l,s,a){const m=o("v-card-title"),_=o("v-text-field"),y=o("v-icon"),k=o("v-alert"),L=o("v-btn"),x=o("v-form"),G=o("v-divider"),v=o("v-icon-login"),T=o("GoogleLogin"),V=o("router-link"),M=o("v-card-text"),E=o("v-card"),N=o("v-col"),S=o("v-row"),q=o("v-container");return g(),u(q,null,{default:n(()=>[t(S,{justify:"center"},{default:n(()=>[t(N,{cols:"12",sm:"8",md:"6"},{default:n(()=>[t(E,{class:"mt-8"},{default:n(()=>[t(m,{class:"text-h4 text-center pt-6",id:"login-heading"},{default:n(()=>e[2]||(e[2]=[d(" Login ")])),_:1,__:[2]}),t(M,null,{default:n(()=>[t(x,{onSubmit:I(a.handleLogin,["prevent"]),"aria-labelledby":"login-heading"},{default:n(()=>[t(_,{modelValue:s.form.email,"onUpdate:modelValue":e[0]||(e[0]=p=>s.form.email=p),label:"Email",type:"email",required:"",rules:[s.rules.required,s.rules.email],"aria-label":"Enter your email address to log in",autocomplete:"email"},null,8,["modelValue","rules"]),t(_,{modelValue:s.form.password,"onUpdate:modelValue":e[1]||(e[1]=p=>s.form.password=p),label:"Password",type:"password",required:"",rules:[s.rules.required],"aria-label":"Enter your password to log in",autocomplete:"current-password"},null,8,["modelValue","rules"]),s.errorMessage?(g(),u(k,{key:0,type:"error",class:"mb-4",border:"start","colored-border":"",elevation:"0",density:"comfortable",style:{"background-color":"#fff",color:"#d32f2f","font-weight":"500"},role:"alert","aria-live":"polite"},{prepend:n(()=>[t(y,{color:"error",size:"24","aria-hidden":"true"},{default:n(()=>e[3]||(e[3]=[d("mdi-alert-circle")])),_:1,__:[3]})]),default:n(()=>[d(" "+w(s.errorMessage),1)]),_:1})):b("",!0),t(L,{type:"submit",color:"primary",block:"",class:"mt-4",loading:s.loading,"aria-label":s.loading?"Logging in...":"Log in to your account"},{default:n(()=>e[4]||(e[4]=[d("Login")])),_:1,__:[4]},8,["loading","aria-label"])]),_:1},8,["onSubmit"]),t(G,{class:"my-4","aria-hidden":"true"}),e[6]||(e[6]=c("div",{class:"text-center text-body-2 mb-2"},[c("span",null,"Or login with")],-1)),c("div",j,[t(T,{callback:a.handleGoogleLogin,"auto-login":"","popup-type":"TOKEN"},{default:n(()=>[t(v,{provider:"google"})]),_:1},8,["callback"]),c("div",D,[t(v,{provider:"github",onClick:a.handleGithubLogin},null,8,["onClick"])])]),c("div",O,[t(V,{to:"/register",class:"text-decoration-none"},{default:n(()=>e[5]||(e[5]=[d(" Don't have an account? Register ")])),_:1,__:[5]})])]),_:1,__:[6]})]),_:1})]),_:1})]),_:1})]),_:1})}const K=h(U,[["render",z],["__scopeId","data-v-8887cd4e"]]);export{K as default};
