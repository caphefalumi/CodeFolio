import{_ as f,g as c,o as d,w as n,h,d as i,r as o,t as b,C as N,a as t,b as a,i as E,f as v}from"./index-AEhTh6Un.js";const B={name:"VIconLogin",props:{provider:{type:String,required:!0}},computed:{providerName(){return this.provider}}};function P(r,e,m,w,s,l){const _=o("v-icon"),u=o("v-btn");return d(),c(u,{class:"login-btn",block:"",elevation:"1"},{default:n(()=>[m.provider==="google"?(d(),c(_,{key:0,left:"",class:"me-2 google-icon",color:"#EA4335"})):m.provider==="github"?(d(),c(_,{key:1,left:"",class:"me-2 github-icon",color:"#4267B2"})):h("",!0),i(" Login with "+b(l.providerName),1)]),_:1})}const U=f(B,[["render",P],["__scopeId","data-v-41519d0b"]]),j={components:{GoogleLogin:N,vIconLogin:U},data(){return{loading:!1,errorMessage:"",form:{email:"",password:""},rules:{required:r=>!!r||"This field is required",email:r=>/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/.test(r)||"Email must be valid"}}},mounted(){window.addEventListener("message",this.receiveGithubToken)},beforeUnmount(){window.removeEventListener("message",this.receiveGithubToken)},methods:{async handleLogin(){var r;this.loading=!0,this.errorMessage="";try{const e=await v.post("/api/auth/login/jwt",{email:this.form.email,password:this.form.password},{withCredentials:!0});sessionStorage.setItem("accessToken",e.data.accessToken),this.$router.push("/")}catch(e){console.error("Login error:",e),this.errorMessage=((r=e.response)==null?void 0:r.status)===401?"Invalid email or password":"Something went wrong. Please try again"}finally{this.loading=!1}},async handleGoogleLogin(r){try{const e=await v.post("/api/auth/login/google",{token:r.access_token});sessionStorage.setItem("accessToken",e.data.accessToken),window.location.href="/"}catch(e){console.error("Google login error:",e),this.errorMessage="Google login failed. Please try again"}},handleGithubLogin(){window.open("/api/auth/login/github","GitHub Login","width=500,height=600")},receiveGithubToken(r){if(r.origin!=="http://localhost:3001")return;const{accessToken:e}=r.data||{};e&&(sessionStorage.setItem("accessToken",e),window.location.href="/")}}},D={class:"login-buttons"},O={class:"login-btn-wrapper"},z={class:"text-center mt-4"};function A(r,e,m,w,s,l){const _=o("v-card-title"),u=o("v-text-field"),k=o("v-icon"),y=o("v-alert"),L=o("v-btn"),x=o("v-form"),G=o("v-divider"),p=o("v-icon-login"),T=o("GoogleLogin"),V=o("router-link"),I=o("v-card-text"),S=o("v-card"),q=o("v-col"),C=o("v-row"),M=o("v-container");return d(),c(M,null,{default:n(()=>[t(C,{justify:"center"},{default:n(()=>[t(q,{cols:"12",sm:"8",md:"6"},{default:n(()=>[t(S,{class:"mt-8"},{default:n(()=>[t(_,{class:"text-h4 text-center pt-6"},{default:n(()=>e[2]||(e[2]=[i(" Login ")])),_:1,__:[2]}),t(I,null,{default:n(()=>[t(x,{onSubmit:E(l.handleLogin,["prevent"])},{default:n(()=>[t(u,{modelValue:s.form.email,"onUpdate:modelValue":e[0]||(e[0]=g=>s.form.email=g),label:"Email",type:"email",required:"",rules:[s.rules.required,s.rules.email]},null,8,["modelValue","rules"]),t(u,{modelValue:s.form.password,"onUpdate:modelValue":e[1]||(e[1]=g=>s.form.password=g),label:"Password",type:"password",required:"",rules:[s.rules.required]},null,8,["modelValue","rules"]),s.errorMessage?(d(),c(y,{key:0,type:"error",class:"mb-4",border:"start","colored-border":"",elevation:"0",density:"comfortable",style:{"background-color":"#fff",color:"#d32f2f","font-weight":"500"}},{prepend:n(()=>[t(k,{color:"error",size:"24"},{default:n(()=>e[3]||(e[3]=[i("mdi-alert-circle")])),_:1,__:[3]})]),default:n(()=>[i(" "+b(s.errorMessage),1)]),_:1})):h("",!0),t(L,{type:"submit",color:"primary",block:"",class:"mt-4",loading:s.loading},{default:n(()=>e[4]||(e[4]=[i("Login")])),_:1,__:[4]},8,["loading"])]),_:1},8,["onSubmit"]),t(G,{class:"my-4"}),e[6]||(e[6]=a("div",{class:"text-center text-body-2 mb-2"},[a("span",null,"Or login with")],-1)),a("div",D,[t(T,{callback:l.handleGoogleLogin,prompt:"","auto-login":"","popup-type":"TOKEN"},{default:n(()=>[t(p,{provider:"google"})]),_:1},8,["callback"]),a("div",O,[t(p,{provider:"github",onClick:l.handleGithubLogin},null,8,["onClick"])])]),a("div",z,[t(V,{to:"/register",class:"text-decoration-none"},{default:n(()=>e[5]||(e[5]=[i(" Don't have an account? Register ")])),_:1,__:[5]})])]),_:1,__:[6]})]),_:1})]),_:1})]),_:1})]),_:1})}const K=f(j,[["render",A],["__scopeId","data-v-9ffcfd33"]]);export{K as default};
