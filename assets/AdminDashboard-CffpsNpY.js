import{_ as H,c as _,o as v,a as t,w as o,b as T,r,d as a,g as x,t as k,e as m,p as E}from"./index-BvTDCMsz.js";const B={name:"AdminDashboard",data(){return{tab:0,users:[],posts:[],userDialog:!1,postDialog:!1,editingUser:null,editingPost:null,userForm:{email:"",username:"",firstName:"",lastName:"",password:""},postForm:{title:"",description:"",githubUrl:"",type:"",tags:""},showPassword:!1,userSearch:"",postSearch:"",userHeaders:[{text:"Email",value:"email"},{text:"Username",value:"username"},{text:"First Name",value:"firstName"},{text:"Last Name",value:"lastName"},{text:"Actions",value:"actions",sortable:!1}],postHeaders:[{text:"Title",value:"title"},{text:"Type",value:"type"},{text:"GitHub",value:"githubUrl"},{text:"Actions",value:"actions",sortable:!1}],currentUser:null}},computed:{isAdmin(){return this.currentUser&&this.currentUser.email==="dangduytoan13l@gmail.com"},filteredUsers(){if(!this.userSearch)return this.users;const i=this.userSearch.toLowerCase();return this.users.filter(e=>{var p,f,s,n;return((p=e.email)==null?void 0:p.toLowerCase().includes(i))||((f=e.username)==null?void 0:f.toLowerCase().includes(i))||((s=e.firstName)==null?void 0:s.toLowerCase().includes(i))||((n=e.lastName)==null?void 0:n.toLowerCase().includes(i))})},filteredPosts(){if(!this.postSearch)return this.posts;const i=this.postSearch.toLowerCase();return this.posts.filter(e=>{var p,f,s;return((p=e.title)==null?void 0:p.toLowerCase().includes(i))||((f=e.description)==null?void 0:f.toLowerCase().includes(i))||((s=e.githubUrl)==null?void 0:s.toLowerCase().includes(i))||(Array.isArray(e.tags)?e.tags.join(",").toLowerCase().includes(i):!1)})}},async mounted(){try{this.currentUser=await E(),this.isAdmin?(this.fetchUsers(),this.fetchPosts()):this.$router.push("/404")}catch{this.$router.push("/404")}},methods:{fetchUsers(){m.get("/api/users").then(i=>{this.users=i.data}).catch(()=>{})},fetchPosts(){m.get("/api/posts").then(i=>{this.posts=i.data}).catch(()=>{})},openUserDialog(){this.editingUser=null,this.userForm={email:"",username:"",firstName:"",lastName:"",password:""},this.userDialog=!0},editUser(i){this.editingUser=i,this.userForm={...i,password:""},this.userDialog=!0},saveUser(){this.editingUser?m.put(`/api/users/${this.editingUser._id}`,this.userForm).then(()=>{this.fetchUsers(),this.closeUserDialog()}):m.post("/api/users",this.userForm).then(()=>{this.fetchUsers(),this.closeUserDialog()})},deleteUser(i){confirm("Delete this user?")&&m.delete(`/api/users/${i._id}`).then(()=>this.fetchUsers())},closeUserDialog(){this.userDialog=!1},openPostDialog(){this.editingPost=null,this.postForm={title:"",description:"",githubUrl:"",type:"",tags:""},this.postDialog=!0},editPost(i){this.editingPost=i,this.postForm={...i},this.postDialog=!0},savePost(){this.editingPost?m.put(`/api/posts/${this.editingPost._id}`,this.postForm).then(()=>{this.fetchPosts(),this.closePostDialog()}):m.post("/api/posts",this.postForm).then(()=>{this.fetchPosts(),this.closePostDialog()})},deletePost(i){confirm("Delete this post?")&&m.delete(`/api/posts/${i._id}`).then(()=>this.fetchPosts())},closePostDialog(){this.postDialog=!1}}},G={key:0},j={key:1},I={key:0},R={key:0};function Y(i,e,p,f,s,n){const N=r("v-alert"),c=r("v-tab"),A=r("v-tabs"),d=r("v-btn"),u=r("v-text-field"),g=r("v-icon"),h=r("v-data-table"),b=r("v-col"),V=r("v-row"),C=r("v-card-title"),P=r("v-card-text"),w=r("v-card-actions"),F=r("v-card"),D=r("v-dialog"),y=r("v-tab-item"),S=r("v-textarea"),L=r("v-tabs-items"),q=r("v-container");return v(),_("div",null,[t(q,null,{default:o(()=>[e[32]||(e[32]=T("h1",{class:"text-h4 mb-6"},"Admin Dashboard",-1)),n.isAdmin?(v(),_("div",j,[t(A,{modelValue:s.tab,"onUpdate:modelValue":e[0]||(e[0]=l=>s.tab=l)},{default:o(()=>[t(c,null,{default:o(()=>e[20]||(e[20]=[a("Users")])),_:1,__:[20]}),t(c,null,{default:o(()=>e[21]||(e[21]=[a("Posts")])),_:1,__:[21]})]),_:1},8,["modelValue"]),t(L,{modelValue:s.tab,"onUpdate:modelValue":e[18]||(e[18]=l=>s.tab=l)},{default:o(()=>[t(y,null,{default:o(()=>[s.tab===0?(v(),_("div",I,[t(V,null,{default:o(()=>[t(b,{cols:"12"},{default:o(()=>[t(d,{color:"primary",class:"mb-4",onClick:e[1]||(e[1]=l=>n.openUserDialog())},{default:o(()=>e[22]||(e[22]=[a("Add User")])),_:1,__:[22]}),t(u,{modelValue:s.userSearch,"onUpdate:modelValue":e[2]||(e[2]=l=>s.userSearch=l),label:"Search users","prepend-inner-icon":"mdi-magnify",variant:"outlined","hide-details":"",class:"mb-4"},null,8,["modelValue"]),t(h,{headers:s.userHeaders,items:n.filteredUsers,"item-key":"_id",class:"elevation-1","items-per-page":10},{"item.actions":o(({item:l})=>[t(d,{icon:"",onClick:U=>n.editUser(l)},{default:o(()=>[t(g,null,{default:o(()=>e[23]||(e[23]=[a("mdi-pencil")])),_:1,__:[23]})]),_:2},1032,["onClick"]),t(d,{icon:"",onClick:U=>n.deleteUser(l)},{default:o(()=>[t(g,null,{default:o(()=>e[24]||(e[24]=[a("mdi-delete")])),_:1,__:[24]})]),_:2},1032,["onClick"])]),_:1},8,["headers","items"])]),_:1})]),_:1}),t(D,{modelValue:s.userDialog,"onUpdate:modelValue":e[9]||(e[9]=l=>s.userDialog=l),"max-width":"500px"},{default:o(()=>[t(F,null,{default:o(()=>[t(C,null,{default:o(()=>[a(k(s.editingUser?"Edit User":"Add User"),1)]),_:1}),t(P,null,{default:o(()=>[t(u,{modelValue:s.userForm.email,"onUpdate:modelValue":e[3]||(e[3]=l=>s.userForm.email=l),label:"Email",required:""},null,8,["modelValue"]),t(u,{modelValue:s.userForm.username,"onUpdate:modelValue":e[4]||(e[4]=l=>s.userForm.username=l),label:"Username",required:""},null,8,["modelValue"]),t(u,{modelValue:s.userForm.firstName,"onUpdate:modelValue":e[5]||(e[5]=l=>s.userForm.firstName=l),label:"First Name",required:""},null,8,["modelValue"]),t(u,{modelValue:s.userForm.lastName,"onUpdate:modelValue":e[6]||(e[6]=l=>s.userForm.lastName=l),label:"Last Name",required:""},null,8,["modelValue"]),t(u,{modelValue:s.userForm.password,"onUpdate:modelValue":e[7]||(e[7]=l=>s.userForm.password=l),label:"Password",type:s.showPassword?"text":"password","append-icon":s.showPassword?"mdi-eye":"mdi-eye-off","onClick:append":e[8]||(e[8]=l=>s.showPassword=!s.showPassword),required:!s.editingUser},null,8,["modelValue","type","append-icon","required"])]),_:1}),t(w,null,{default:o(()=>[t(d,{color:"primary",onClick:n.saveUser},{default:o(()=>e[25]||(e[25]=[a("Save")])),_:1,__:[25]},8,["onClick"]),t(d,{text:"",onClick:n.closeUserDialog},{default:o(()=>e[26]||(e[26]=[a("Cancel")])),_:1,__:[26]},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])):x("",!0)]),_:1}),t(y,null,{default:o(()=>[s.tab===1?(v(),_("div",R,[t(V,null,{default:o(()=>[t(b,{cols:"12"},{default:o(()=>[t(d,{color:"primary",class:"mb-4",onClick:e[10]||(e[10]=l=>n.openPostDialog())},{default:o(()=>e[27]||(e[27]=[a("Add Post")])),_:1,__:[27]}),t(u,{modelValue:s.postSearch,"onUpdate:modelValue":e[11]||(e[11]=l=>s.postSearch=l),label:"Search posts","prepend-inner-icon":"mdi-magnify",variant:"outlined","hide-details":"",class:"mb-4"},null,8,["modelValue"]),t(h,{headers:s.postHeaders,items:n.filteredPosts,"item-key":"_id",class:"elevation-1","items-per-page":10},{"item.actions":o(({item:l})=>[t(d,{icon:"",onClick:U=>n.editPost(l)},{default:o(()=>[t(g,null,{default:o(()=>e[28]||(e[28]=[a("mdi-pencil")])),_:1,__:[28]})]),_:2},1032,["onClick"]),t(d,{icon:"",onClick:U=>n.deletePost(l)},{default:o(()=>[t(g,null,{default:o(()=>e[29]||(e[29]=[a("mdi-delete")])),_:1,__:[29]})]),_:2},1032,["onClick"])]),_:1},8,["headers","items"])]),_:1})]),_:1}),t(D,{modelValue:s.postDialog,"onUpdate:modelValue":e[17]||(e[17]=l=>s.postDialog=l),"max-width":"600px"},{default:o(()=>[t(F,null,{default:o(()=>[t(C,null,{default:o(()=>[a(k(s.editingPost?"Edit Post":"Add Post"),1)]),_:1}),t(P,null,{default:o(()=>[t(u,{modelValue:s.postForm.title,"onUpdate:modelValue":e[12]||(e[12]=l=>s.postForm.title=l),label:"Title",required:""},null,8,["modelValue"]),t(S,{modelValue:s.postForm.description,"onUpdate:modelValue":e[13]||(e[13]=l=>s.postForm.description=l),label:"Description"},null,8,["modelValue"]),t(u,{modelValue:s.postForm.githubUrl,"onUpdate:modelValue":e[14]||(e[14]=l=>s.postForm.githubUrl=l),label:"GitHub URL"},null,8,["modelValue"]),t(u,{modelValue:s.postForm.type,"onUpdate:modelValue":e[15]||(e[15]=l=>s.postForm.type=l),label:"Type"},null,8,["modelValue"]),t(u,{modelValue:s.postForm.tags,"onUpdate:modelValue":e[16]||(e[16]=l=>s.postForm.tags=l),label:"Tags (comma separated)"},null,8,["modelValue"])]),_:1}),t(w,null,{default:o(()=>[t(d,{color:"primary",onClick:n.savePost},{default:o(()=>e[30]||(e[30]=[a("Save")])),_:1,__:[30]},8,["onClick"]),t(d,{text:"",onClick:n.closePostDialog},{default:o(()=>e[31]||(e[31]=[a("Cancel")])),_:1,__:[31]},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])):x("",!0)]),_:1})]),_:1},8,["modelValue"])])):(v(),_("div",G,[t(N,{type:"error"},{default:o(()=>e[19]||(e[19]=[a("Access denied. You are not the admin.")])),_:1,__:[19]})]))]),_:1,__:[32]})])}const J=H(B,[["render",Y],["__scopeId","data-v-bd2fb461"]]);export{J as default};
